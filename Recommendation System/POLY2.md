## POLY2

### 特征交叉

- **针对问题**：逻辑回归存在的问题就是，只对单一特征做简单加权，不具备特征交叉生成**组合特征**的能力，表达能力受限
- **数学模型：**

​						  					$z = w_0 + \sum_{j=1}^nw_ix_j+\sum_{j=1}^{n-1}\sum_{k=j+1}^{n}w_{jk}X_jX_k$

​						   			 								$\hat y = \frac{1}{1+e^{-z}}$

​		因为矩阵为特征矩阵，所以只采用矩阵上半部分（k为什么送j+1开始取得原因）

- **损失函数**：具体看应用场景

  推荐场景中常见为点击率预估二分类问题：交叉熵损失

  - ###### **梯度更新**：

  - ![image-20211202223748023](https://github.com/HenryWang628/Paper_Reading/blob/main/pic/POLY2.png?raw=true)

    （加号是因为交叉熵中带有负号）

```python
#二次项的代码
for i in range(n-1):
	for j in range(i, n):
		sum += w[i]*x[i]*x[j]
return sum     
#时间复杂度从O(n)——>O(n^2)
```

- **优缺点**：
  - 优点：
    - 保留了逻辑回归的优点：充分利用用户特征，物品特征，上下文特征
    - 一定程度上解决了特征组合的问题
  - 缺点：
    - one hot编码处理类别型数据时，会让特征向量变得极度系数，而无选择的暴力组合特征，会让原本的特征变得更加系数，导致大部分交叉特征的权重缺乏有效的数据进行训练，无法收敛
    - 训练复杂度从O(n)——>O(n^2)
